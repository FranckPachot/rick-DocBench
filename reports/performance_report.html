<!DOCTYPE html>
<html>
<head>
    <title>DocBench Performance Report - BSON vs OSON Server-Side Updates</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; margin: 40px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h1 { color: #333; border-bottom: 3px solid #0066cc; padding-bottom: 10px; }
        h2 { color: #0066cc; margin-top: 30px; }
        h3 { color: #666; }
        table { border-collapse: collapse; width: 100%; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: right; }
        th { background: #0066cc; color: white; }
        td:first-child { text-align: left; font-weight: 500; }
        tr:nth-child(even) { background: #f9f9f9; }
        tr:hover { background: #f0f7ff; }
        .winner-mongo { color: #cc6600; font-weight: bold; }
        .winner-oson { color: #006600; font-weight: bold; }
        .summary-box { background: #f0f7ff; border: 1px solid #0066cc; border-radius: 8px; padding: 20px; margin: 20px 0; }
        .highlight { background: #ffffcc; }
        .metric { font-size: 24px; font-weight: bold; color: #0066cc; }
        .section { margin: 30px 0; }
        .note { color: #666; font-style: italic; font-size: 0.9em; }
        .comparison { display: flex; gap: 20px; }
        .comparison > div { flex: 1; }
    </style>
</head>
<body>
<div class="container">
    <h1>DocBench Performance Report</h1>
    <p class="note">MongoDB $set vs Oracle JSON_TRANSFORM - Server-Side Update Benchmarks</p>
<div class="summary-box">
    <h2>Executive Summary</h2>
    <div class="comparison">
        <div>
            <h3>Raw Performance</h3>
            <p class="metric">MongoDB 0.86x faster</p>
            <p>MongoDB wins: 2 | OSON wins: 23</p>
        </div>
        <div>
            <h3>Adjusted (Protocol Overhead Removed)</h3>
            <p class="metric">MongoDB 1.04x faster</p>
            <p>MongoDB wins: 13 | OSON wins: 12</p>
        </div>
    </div>
</div>
<div class="section">
    <h2>Protocol Overhead Analysis</h2>
    <table>
        <tr><th>Metric</th><th>Value</th></tr>
        <tr><td>MongoDB baseline (non-JSON $inc)</td><td>1,958,470 ns</td></tr>
        <tr><td>Oracle baseline (non-JSON UPDATE)</td><td>1,012,620 ns</td></tr>
        <tr><td>Oracle protocol overhead delta</td><td>-945,850 ns (0.52x MongoDB)</td></tr>
        <tr><td>Overhead as % of Oracle baseline</td><td>-93.4%</td></tr>
    </table>
    <p class="note">The protocol overhead is a fixed cost per database round-trip, regardless of JSON operation complexity.
    Oracle's SQL/JDBC protocol has higher latency than MongoDB's binary wire protocol.</p>
</div>
<div class="section">
    <h2>Raw Performance Results</h2>
    <table>
        <tr><th>Test Case</th><th>MongoDB (ns)</th><th>OSON (ns)</th><th>Ratio</th><th>Winner</th></tr>
<tr><td>Single update 100 fields</td><td>1,952,820</td><td>1,310,893</td><td>0.67x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Single update 500 fields</td><td>1,987,706</td><td>1,108,162</td><td>0.56x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Single update 1000 fields</td><td>1,944,092</td><td>1,074,378</td><td>0.55x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Multi-update 3 fields</td><td>1,971,949</td><td>1,309,900</td><td>0.66x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Multi-update 5 fields</td><td>2,000,798</td><td>1,301,165</td><td>0.65x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Multi-update 10 fields</td><td>1,959,636</td><td>1,303,595</td><td>0.67x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Large doc ~10KB</td><td>1,951,444</td><td>1,062,652</td><td>0.54x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Large doc ~50KB</td><td>1,986,630</td><td>1,058,811</td><td>0.53x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Large doc ~100KB</td><td>1,984,275</td><td>1,103,444</td><td>0.56x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Large doc ~1024KB</td><td>2,798,974</td><td>1,059,747</td><td>0.38x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Large doc ~4096KB</td><td>7,250,427</td><td>1,108,646</td><td>0.15x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Scalar push 1x1</td><td>1,937,191</td><td>1,137,217</td><td>0.59x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Scalar push 10x1</td><td>20,139,268</td><td>12,201,058</td><td>0.61x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Object push 1x1</td><td>1,908,510</td><td>1,247,177</td><td>0.65x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Object push 10x1</td><td>20,819,024</td><td>13,547,134</td><td>0.65x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Scalar delete beginning</td><td>2,311,899</td><td>1,156,953</td><td>0.50x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Scalar delete middle</td><td>3,928,843</td><td>1,160,904</td><td>0.30x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Scalar delete end</td><td>2,238,271</td><td>1,225,322</td><td>0.55x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Object delete beginning</td><td>2,247,999</td><td>1,067,409</td><td>0.47x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Object delete middle</td><td>4,127,897</td><td>1,068,444</td><td>0.26x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Object delete end</td><td>2,222,301</td><td>1,045,862</td><td>0.47x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Large 1MB scalar array</td><td>3,248,805</td><td>7,586,679</td><td>2.34x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large 4MB scalar array</td><td>7,817,765</td><td>38,106,668</td><td>4.87x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large 1MB object array</td><td>12,346,461</td><td>4,747,576</td><td>0.38x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Large 4MB object array</td><td>14,521,214</td><td>11,346,450</td><td>0.78x</td><td class='winner-oson'>OSON</td></tr>
</table></div><div class="section">
    <h2>Adjusted Performance (Protocol Overhead Removed)</h2>
    <p class="note">Shows what OSON performance would be if Oracle's protocol matched MongoDB's speed.</p>
    <table>
        <tr><th>Test Case</th><th>MongoDB (ns)</th><th>OSON Adjusted (ns)</th><th>Overhead Removed (ns)</th><th>Adj Ratio</th><th>Winner</th></tr>
<tr><td>Single update 100 fields</td><td>1,952,820</td><td>2,256,743</td><td>-945,850</td><td>1.16x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Single update 500 fields</td><td>1,987,706</td><td>2,054,012</td><td>-945,850</td><td>1.03x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Single update 1000 fields</td><td>1,944,092</td><td>2,020,228</td><td>-945,850</td><td>1.04x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Multi-update 3 fields</td><td>1,971,949</td><td>2,255,750</td><td>-945,850</td><td>1.14x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Multi-update 5 fields</td><td>2,000,798</td><td>2,247,015</td><td>-945,850</td><td>1.12x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Multi-update 10 fields</td><td>1,959,636</td><td>2,249,445</td><td>-945,850</td><td>1.15x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large doc ~10KB</td><td>1,951,444</td><td>2,008,502</td><td>-945,850</td><td>1.03x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large doc ~50KB</td><td>1,986,630</td><td>2,004,661</td><td>-945,850</td><td>1.01x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large doc ~100KB</td><td>1,984,275</td><td>2,049,294</td><td>-945,850</td><td>1.03x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr class='highlight'><td>Large doc ~1024KB</td><td>2,798,974</td><td>2,005,597</td><td>-945,850</td><td>0.72x</td><td class='winner-oson'>OSON</td></tr>
<tr class='highlight'><td>Large doc ~4096KB</td><td>7,250,427</td><td>2,054,496</td><td>-945,850</td><td>0.28x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Scalar push 1x1</td><td>1,937,191</td><td>2,083,067</td><td>-945,850</td><td>1.08x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr class='highlight'><td>Scalar push 10x1</td><td>20,139,268</td><td>13,146,908</td><td>-945,850</td><td>0.65x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Object push 1x1</td><td>1,908,510</td><td>2,193,027</td><td>-945,850</td><td>1.15x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr class='highlight'><td>Object push 10x1</td><td>20,819,024</td><td>14,492,984</td><td>-945,850</td><td>0.70x</td><td class='winner-oson'>OSON</td></tr>
<tr class='highlight'><td>Scalar delete beginning</td><td>2,311,899</td><td>2,102,803</td><td>-945,850</td><td>0.91x</td><td class='winner-oson'>OSON</td></tr>
<tr class='highlight'><td>Scalar delete middle</td><td>3,928,843</td><td>2,106,754</td><td>-945,850</td><td>0.54x</td><td class='winner-oson'>OSON</td></tr>
<tr class='highlight'><td>Scalar delete end</td><td>2,238,271</td><td>2,171,172</td><td>-945,850</td><td>0.97x</td><td class='winner-oson'>OSON</td></tr>
<tr class='highlight'><td>Object delete beginning</td><td>2,247,999</td><td>2,013,259</td><td>-945,850</td><td>0.90x</td><td class='winner-oson'>OSON</td></tr>
<tr class='highlight'><td>Object delete middle</td><td>4,127,897</td><td>2,014,294</td><td>-945,850</td><td>0.49x</td><td class='winner-oson'>OSON</td></tr>
<tr class='highlight'><td>Object delete end</td><td>2,222,301</td><td>1,991,712</td><td>-945,850</td><td>0.90x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Large 1MB scalar array</td><td>3,248,805</td><td>8,532,529</td><td>-945,850</td><td>2.63x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large 4MB scalar array</td><td>7,817,765</td><td>39,052,518</td><td>-945,850</td><td>5.00x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr class='highlight'><td>Large 1MB object array</td><td>12,346,461</td><td>5,693,426</td><td>-945,850</td><td>0.46x</td><td class='winner-oson'>OSON</td></tr>
<tr class='highlight'><td>Large 4MB object array</td><td>14,521,214</td><td>12,292,300</td><td>-945,850</td><td>0.85x</td><td class='winner-oson'>OSON</td></tr>
</table></div><div class="section">
    <h2>Key Insights</h2>
    <ul>
        <li><strong>Protocol overhead dominates small operations</strong> - Oracle's ~-945,850 ns fixed overhead masks OSON's JSON manipulation efficiency for typical sub-100KB updates.</li>
        <li><strong>OSON partial updates shine at scale</strong> - At 1MB+ document sizes, MongoDB's O(n) document rewrite cost exceeds Oracle's protocol overhead.</li>
        <li><strong>MongoDB's wire protocol is highly optimized</strong> - The binary BSON protocol is ~0.5x faster than JDBC/SQL for round-trips.</li>
        <li><strong>OSON wins increase with overhead removed</strong> - From 23 to 12 wins, particularly for large documents and middle-position array operations.</li>
    </ul>
</div>
<div class="note" style="margin-top: 40px; text-align: center;">
    Generated by DocBench - BSON vs OSON Benchmark Suite
</div>
</div>
</body>
</html>

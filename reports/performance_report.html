<!DOCTYPE html>
<html>
<head>
    <title>DocBench Performance Report - BSON vs OSON Server-Side Updates</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; margin: 40px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h1 { color: #333; border-bottom: 3px solid #0066cc; padding-bottom: 10px; }
        h2 { color: #0066cc; margin-top: 30px; }
        h3 { color: #666; }
        table { border-collapse: collapse; width: 100%; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: right; }
        th { background: #0066cc; color: white; }
        td:first-child { text-align: left; font-weight: 500; }
        tr:nth-child(even) { background: #f9f9f9; }
        tr:hover { background: #f0f7ff; }
        .winner-mongo { color: #cc6600; font-weight: bold; }
        .winner-oson { color: #006600; font-weight: bold; }
        .summary-box { background: #f0f7ff; border: 1px solid #0066cc; border-radius: 8px; padding: 20px; margin: 20px 0; }
        .highlight { background: #ffffcc; }
        .metric { font-size: 24px; font-weight: bold; color: #0066cc; }
        .section { margin: 30px 0; }
        .note { color: #666; font-style: italic; font-size: 0.9em; }
        .comparison { display: flex; gap: 20px; }
        .comparison > div { flex: 1; }
    </style>
</head>
<body>
<div class="container">
    <h1>DocBench Performance Report</h1>
    <p class="note">MongoDB $set vs Oracle JSON_TRANSFORM - Server-Side Update Benchmarks</p>
<div class="summary-box">
    <h2>Executive Summary</h2>
    <div class="comparison">
        <div>
            <h3>Raw Performance</h3>
            <p class="metric">MongoDB 1.46x faster</p>
            <p>MongoDB wins: 23 | OSON wins: 2</p>
        </div>
        <div>
            <h3>Adjusted (Protocol Overhead Removed)</h3>
            <p class="metric">MongoDB 1.20x faster</p>
            <p>MongoDB wins: 20 | OSON wins: 5</p>
        </div>
    </div>
</div>
<div class="section">
    <h2>Protocol Overhead Analysis</h2>
    <table>
        <tr><th>Metric</th><th>Value</th></tr>
        <tr><td>MongoDB baseline (non-JSON $inc)</td><td>478,725 ns</td></tr>
        <tr><td>Oracle baseline (non-JSON UPDATE)</td><td>925,233 ns</td></tr>
        <tr><td>Oracle protocol overhead delta</td><td>446,508 ns (1.93x MongoDB)</td></tr>
        <tr><td>Overhead as % of Oracle baseline</td><td>48.3%</td></tr>
    </table>
    <p class="note">The protocol overhead is a fixed cost per database round-trip, regardless of JSON operation complexity.
    Oracle's SQL/JDBC protocol has higher latency than MongoDB's binary wire protocol.</p>
</div>
<div class="section">
    <h2>Raw Performance Results</h2>
    <table>
        <tr><th>Test Case</th><th>MongoDB (ns)</th><th>OSON (ns)</th><th>Ratio</th><th>Winner</th></tr>
<tr><td>Single update 100 fields</td><td>397,800</td><td>1,021,759</td><td>2.57x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Single update 500 fields</td><td>410,448</td><td>977,731</td><td>2.38x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Single update 1000 fields</td><td>424,410</td><td>952,208</td><td>2.24x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Multi-update 3 fields</td><td>382,506</td><td>1,022,015</td><td>2.67x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Multi-update 5 fields</td><td>397,164</td><td>995,682</td><td>2.51x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Multi-update 10 fields</td><td>386,436</td><td>1,009,321</td><td>2.61x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large doc ~10KB</td><td>411,571</td><td>929,709</td><td>2.26x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large doc ~50KB</td><td>339,353</td><td>924,534</td><td>2.72x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large doc ~100KB</td><td>348,009</td><td>930,821</td><td>2.67x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large doc ~1024KB</td><td>547,307</td><td>959,234</td><td>1.75x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large doc ~4096KB</td><td>1,762,974</td><td>938,691</td><td>0.53x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Scalar push 1x1</td><td>368,670</td><td>1,002,950</td><td>2.72x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Scalar push 10x1</td><td>3,833,524</td><td>10,287,764</td><td>2.68x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Object push 1x1</td><td>421,622</td><td>1,024,206</td><td>2.43x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Object push 10x1</td><td>5,548,455</td><td>10,580,755</td><td>1.91x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Scalar delete beginning</td><td>332,642</td><td>929,357</td><td>2.79x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Scalar delete middle</td><td>679,810</td><td>1,144,363</td><td>1.68x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Scalar delete end</td><td>329,305</td><td>983,945</td><td>2.99x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Object delete beginning</td><td>365,884</td><td>914,217</td><td>2.50x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Object delete middle</td><td>715,548</td><td>917,999</td><td>1.28x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Object delete end</td><td>392,661</td><td>909,492</td><td>2.32x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large 1MB scalar array</td><td>2,019,568</td><td>2,729,501</td><td>1.35x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large 4MB scalar array</td><td>8,817,881</td><td>10,557,933</td><td>1.20x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large 1MB object array</td><td>2,863,480</td><td>2,936,659</td><td>1.03x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large 4MB object array</td><td>10,525,215</td><td>7,040,836</td><td>0.67x</td><td class='winner-oson'>OSON</td></tr>
</table></div><div class="section">
    <h2>Adjusted Performance (Protocol Overhead Removed)</h2>
    <p class="note">Shows what OSON performance would be if Oracle's protocol matched MongoDB's speed.</p>
    <table>
        <tr><th>Test Case</th><th>MongoDB (ns)</th><th>OSON Adjusted (ns)</th><th>Overhead Removed (ns)</th><th>Adj Ratio</th><th>Winner</th></tr>
<tr><td>Single update 100 fields</td><td>397,800</td><td>575,251</td><td>446,508</td><td>1.45x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Single update 500 fields</td><td>410,448</td><td>531,223</td><td>446,508</td><td>1.29x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Single update 1000 fields</td><td>424,410</td><td>505,700</td><td>446,508</td><td>1.19x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Multi-update 3 fields</td><td>382,506</td><td>575,507</td><td>446,508</td><td>1.50x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Multi-update 5 fields</td><td>397,164</td><td>549,174</td><td>446,508</td><td>1.38x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Multi-update 10 fields</td><td>386,436</td><td>562,813</td><td>446,508</td><td>1.46x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large doc ~10KB</td><td>411,571</td><td>483,201</td><td>446,508</td><td>1.17x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large doc ~50KB</td><td>339,353</td><td>478,026</td><td>446,508</td><td>1.41x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large doc ~100KB</td><td>348,009</td><td>484,313</td><td>446,508</td><td>1.39x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr class='highlight'><td>Large doc ~1024KB</td><td>547,307</td><td>512,726</td><td>446,508</td><td>0.94x</td><td class='winner-oson'>OSON</td></tr>
<tr class='highlight'><td>Large doc ~4096KB</td><td>1,762,974</td><td>492,183</td><td>446,508</td><td>0.28x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Scalar push 1x1</td><td>368,670</td><td>556,442</td><td>446,508</td><td>1.51x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Scalar push 10x1</td><td>3,833,524</td><td>9,841,256</td><td>446,508</td><td>2.57x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Object push 1x1</td><td>421,622</td><td>577,698</td><td>446,508</td><td>1.37x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Object push 10x1</td><td>5,548,455</td><td>10,134,247</td><td>446,508</td><td>1.83x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Scalar delete beginning</td><td>332,642</td><td>482,849</td><td>446,508</td><td>1.45x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Scalar delete middle</td><td>679,810</td><td>697,855</td><td>446,508</td><td>1.03x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Scalar delete end</td><td>329,305</td><td>537,437</td><td>446,508</td><td>1.63x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Object delete beginning</td><td>365,884</td><td>467,709</td><td>446,508</td><td>1.28x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr class='highlight'><td>Object delete middle</td><td>715,548</td><td>471,491</td><td>446,508</td><td>0.66x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Object delete end</td><td>392,661</td><td>462,984</td><td>446,508</td><td>1.18x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large 1MB scalar array</td><td>2,019,568</td><td>2,282,993</td><td>446,508</td><td>1.13x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large 4MB scalar array</td><td>8,817,881</td><td>10,111,425</td><td>446,508</td><td>1.15x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr class='highlight'><td>Large 1MB object array</td><td>2,863,480</td><td>2,490,151</td><td>446,508</td><td>0.87x</td><td class='winner-oson'>OSON</td></tr>
<tr class='highlight'><td>Large 4MB object array</td><td>10,525,215</td><td>6,594,328</td><td>446,508</td><td>0.63x</td><td class='winner-oson'>OSON</td></tr>
</table></div><div class="section">
    <h2>Key Insights</h2>
    <ul>
        <li><strong>Protocol overhead dominates small operations</strong> - Oracle's ~446,508 ns fixed overhead masks OSON's JSON manipulation efficiency for typical sub-100KB updates.</li>
        <li><strong>OSON partial updates shine at scale</strong> - At 1MB+ document sizes, MongoDB's O(n) document rewrite cost exceeds Oracle's protocol overhead.</li>
        <li><strong>MongoDB's wire protocol is highly optimized</strong> - The binary BSON protocol is ~1.9x faster than JDBC/SQL for round-trips.</li>
        <li><strong>OSON wins increase with overhead removed</strong> - From 2 to 5 wins, particularly for large documents and middle-position array operations.</li>
    </ul>
</div>
<div class="note" style="margin-top: 40px; text-align: center;">
    Generated by DocBench - BSON vs OSON Benchmark Suite
</div>
</div>
</body>
</html>

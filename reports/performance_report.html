<!DOCTYPE html>
<html>
<head>
    <title>DocBench Performance Report - BSON vs OSON Server-Side Updates</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; margin: 40px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h1 { color: #333; border-bottom: 3px solid #0066cc; padding-bottom: 10px; }
        h2 { color: #0066cc; margin-top: 30px; }
        h3 { color: #666; }
        table { border-collapse: collapse; width: 100%; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: right; }
        th { background: #0066cc; color: white; }
        td:first-child { text-align: left; font-weight: 500; }
        tr:nth-child(even) { background: #f9f9f9; }
        tr:hover { background: #f0f7ff; }
        .winner-mongo { color: #cc6600; font-weight: bold; }
        .winner-oson { color: #006600; font-weight: bold; }
        .summary-box { background: #f0f7ff; border: 1px solid #0066cc; border-radius: 8px; padding: 20px; margin: 20px 0; }
        .highlight { background: #ffffcc; }
        .metric { font-size: 24px; font-weight: bold; color: #0066cc; }
        .section { margin: 30px 0; }
        .note { color: #666; font-style: italic; font-size: 0.9em; }
        .comparison { display: flex; gap: 20px; }
        .comparison > div { flex: 1; }
    </style>
</head>
<body>
<div class="container">
    <h1>DocBench Performance Report</h1>
    <p class="note">MongoDB $set vs Oracle JSON_TRANSFORM - Server-Side Update Benchmarks</p>
<div class="summary-box">
    <h2>Executive Summary</h2>
    <div class="comparison">
        <div>
            <h3>Raw Performance</h3>
            <p class="metric">MongoDB 1.58x faster</p>
            <p>MongoDB wins: 22 | OSON wins: 3</p>
        </div>
        <div>
            <h3>Adjusted (Protocol Overhead Removed)</h3>
            <p class="metric">MongoDB 1.32x faster</p>
            <p>MongoDB wins: 20 | OSON wins: 5</p>
        </div>
    </div>
</div>
<div class="section">
    <h2>Protocol Overhead Analysis</h2>
    <table>
        <tr><th>Metric</th><th>Value</th></tr>
        <tr><td>MongoDB baseline (non-JSON $inc)</td><td>418,096 ns</td></tr>
        <tr><td>Oracle baseline (non-JSON UPDATE)</td><td>862,908 ns</td></tr>
        <tr><td>Oracle protocol overhead delta</td><td>444,812 ns (2.06x MongoDB)</td></tr>
        <tr><td>Overhead as % of Oracle baseline</td><td>51.5%</td></tr>
    </table>
    <p class="note">The protocol overhead is a fixed cost per database round-trip, regardless of JSON operation complexity.
    Oracle's SQL/JDBC protocol has higher latency than MongoDB's binary wire protocol.</p>
</div>
<div class="section">
    <h2>Raw Performance Results</h2>
    <table>
        <tr><th>Test Case</th><th>MongoDB (ns)</th><th>OSON (ns)</th><th>Ratio</th><th>Winner</th></tr>
<tr><td>Single update 100 fields</td><td>396,494</td><td>1,011,496</td><td>2.55x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Single update 500 fields</td><td>407,931</td><td>953,198</td><td>2.34x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Single update 1000 fields</td><td>407,934</td><td>956,969</td><td>2.35x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Multi-update 3 fields</td><td>386,053</td><td>1,031,672</td><td>2.67x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Multi-update 5 fields</td><td>388,155</td><td>996,710</td><td>2.57x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Multi-update 10 fields</td><td>383,986</td><td>986,044</td><td>2.57x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large doc ~10KB</td><td>332,731</td><td>911,406</td><td>2.74x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large doc ~50KB</td><td>333,109</td><td>914,550</td><td>2.75x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large doc ~100KB</td><td>349,278</td><td>941,474</td><td>2.70x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large doc ~1024KB</td><td>556,663</td><td>957,910</td><td>1.72x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large doc ~4096KB</td><td>1,856,564</td><td>920,924</td><td>0.50x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Scalar push 1x1</td><td>324,619</td><td>1,208,708</td><td>3.72x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Scalar push 10x1</td><td>3,649,183</td><td>9,658,754</td><td>2.65x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Object push 1x1</td><td>401,240</td><td>1,003,650</td><td>2.50x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Object push 10x1</td><td>5,429,453</td><td>13,049,805</td><td>2.40x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Scalar delete beginning</td><td>322,153</td><td>1,155,175</td><td>3.59x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Scalar delete middle</td><td>663,124</td><td>1,335,995</td><td>2.01x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Scalar delete end</td><td>321,827</td><td>1,086,647</td><td>3.38x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Object delete beginning</td><td>353,665</td><td>989,974</td><td>2.80x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Object delete middle</td><td>694,625</td><td>965,216</td><td>1.39x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Object delete end</td><td>351,644</td><td>1,045,668</td><td>2.97x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large 1MB scalar array</td><td>2,173,533</td><td>2,911,025</td><td>1.34x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large 4MB scalar array</td><td>8,699,499</td><td>12,071,771</td><td>1.39x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large 1MB object array</td><td>3,058,806</td><td>2,395,380</td><td>0.78x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Large 4MB object array</td><td>10,508,322</td><td>8,040,781</td><td>0.77x</td><td class='winner-oson'>OSON</td></tr>
</table></div><div class="section">
    <h2>Adjusted Performance (Protocol Overhead Removed)</h2>
    <p class="note">Shows what OSON performance would be if Oracle's protocol matched MongoDB's speed.</p>
    <table>
        <tr><th>Test Case</th><th>MongoDB (ns)</th><th>OSON Adjusted (ns)</th><th>Overhead Removed (ns)</th><th>Adj Ratio</th><th>Winner</th></tr>
<tr><td>Single update 100 fields</td><td>396,494</td><td>566,684</td><td>444,812</td><td>1.43x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Single update 500 fields</td><td>407,931</td><td>508,386</td><td>444,812</td><td>1.25x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Single update 1000 fields</td><td>407,934</td><td>512,157</td><td>444,812</td><td>1.26x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Multi-update 3 fields</td><td>386,053</td><td>586,860</td><td>444,812</td><td>1.52x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Multi-update 5 fields</td><td>388,155</td><td>551,898</td><td>444,812</td><td>1.42x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Multi-update 10 fields</td><td>383,986</td><td>541,232</td><td>444,812</td><td>1.41x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large doc ~10KB</td><td>332,731</td><td>466,594</td><td>444,812</td><td>1.40x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large doc ~50KB</td><td>333,109</td><td>469,738</td><td>444,812</td><td>1.41x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large doc ~100KB</td><td>349,278</td><td>496,662</td><td>444,812</td><td>1.42x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr class='highlight'><td>Large doc ~1024KB</td><td>556,663</td><td>513,098</td><td>444,812</td><td>0.92x</td><td class='winner-oson'>OSON</td></tr>
<tr class='highlight'><td>Large doc ~4096KB</td><td>1,856,564</td><td>476,112</td><td>444,812</td><td>0.26x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Scalar push 1x1</td><td>324,619</td><td>763,896</td><td>444,812</td><td>2.35x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Scalar push 10x1</td><td>3,649,183</td><td>9,213,942</td><td>444,812</td><td>2.52x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Object push 1x1</td><td>401,240</td><td>558,838</td><td>444,812</td><td>1.39x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Object push 10x1</td><td>5,429,453</td><td>12,604,993</td><td>444,812</td><td>2.32x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Scalar delete beginning</td><td>322,153</td><td>710,363</td><td>444,812</td><td>2.21x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Scalar delete middle</td><td>663,124</td><td>891,183</td><td>444,812</td><td>1.34x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Scalar delete end</td><td>321,827</td><td>641,835</td><td>444,812</td><td>1.99x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Object delete beginning</td><td>353,665</td><td>545,162</td><td>444,812</td><td>1.54x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr class='highlight'><td>Object delete middle</td><td>694,625</td><td>520,404</td><td>444,812</td><td>0.75x</td><td class='winner-oson'>OSON</td></tr>
<tr><td>Object delete end</td><td>351,644</td><td>600,856</td><td>444,812</td><td>1.71x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large 1MB scalar array</td><td>2,173,533</td><td>2,466,213</td><td>444,812</td><td>1.13x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr><td>Large 4MB scalar array</td><td>8,699,499</td><td>11,626,959</td><td>444,812</td><td>1.34x</td><td class='winner-mongo'>MongoDB</td></tr>
<tr class='highlight'><td>Large 1MB object array</td><td>3,058,806</td><td>1,950,568</td><td>444,812</td><td>0.64x</td><td class='winner-oson'>OSON</td></tr>
<tr class='highlight'><td>Large 4MB object array</td><td>10,508,322</td><td>7,595,969</td><td>444,812</td><td>0.72x</td><td class='winner-oson'>OSON</td></tr>
</table></div><div class="section">
    <h2>Key Insights</h2>
    <ul>
        <li><strong>Protocol overhead dominates small operations</strong> - Oracle's ~444,812 ns fixed overhead masks OSON's JSON manipulation efficiency for typical sub-100KB updates.</li>
        <li><strong>OSON partial updates shine at scale</strong> - At 1MB+ document sizes, MongoDB's O(n) document rewrite cost exceeds Oracle's protocol overhead.</li>
        <li><strong>MongoDB's wire protocol is highly optimized</strong> - The binary BSON protocol is ~2.1x faster than JDBC/SQL for round-trips.</li>
        <li><strong>OSON wins increase with overhead removed</strong> - From 3 to 5 wins, particularly for large documents and middle-position array operations.</li>
    </ul>
</div>
<div class="note" style="margin-top: 40px; text-align: center;">
    Generated by DocBench - BSON vs OSON Benchmark Suite
</div>
</div>
</body>
</html>
